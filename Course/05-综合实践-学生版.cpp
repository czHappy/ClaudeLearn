// 05-ç»¼åˆå®è·µ-å­¦ç”Ÿç‰ˆ.cpp
// é­”æ³•å­¦é™¢æˆ˜æ–—ç«æŠ€åœº - å­¦ç”Ÿå®è·µç‰ˆ
// è¯·åœ¨æ ‡è®°äº† TODO çš„åœ°æ–¹è¡¥å……ä»£ç 

#include <iostream>
#include <string>
#include <cstdlib>
#include <ctime>
using namespace std;

// ============================================
// Character åŸºç±» - è¯·å®Œæˆæ­¤ç±»
// ============================================
class Character {
protected:
    string name;
    int hp;
    int maxHp;
    int attackPower;
    string school;

public:
    // TODO: å®ç°æ„é€ å‡½æ•°
    Character(string n, int health, int attack, string sch) {
        // åœ¨è¿™é‡Œåˆå§‹åŒ–æ‰€æœ‰æˆå‘˜å˜é‡
    }

    // TODO: å®ç°çº¯è™šå‡½æ•° attackï¼ˆå­ç±»å¿…é¡»å®ç°ï¼‰
    virtual void attack(Character* target) = 0;

    // TODO: å®ç° takeDamage æ–¹æ³•
    void takeDamage(int damage) {
        // å‡å°‘ç”Ÿå‘½å€¼ï¼Œç¡®ä¿ä¸ä½äº0
    }

    // TODO: å®ç° isAlive æ–¹æ³•
    bool isAlive() {
        // è¿”å›è§’è‰²æ˜¯å¦è¿˜æ´»ç€
        return false;  // ä¿®æ”¹è¿™é‡Œ
    }

    // TODO: å®ç° showStatus æ–¹æ³•ï¼ˆæ˜¾ç¤ºç”Ÿå‘½å€¼è¿›åº¦æ¡ï¼‰
    void showStatus() {
        // æ ¼å¼ï¼šè§’è‰²å [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘] 80/100 HP
        // æç¤ºï¼š10æ ¼è¿›åº¦æ¡ï¼Œæ ¹æ® hp/maxHp è®¡ç®—å¡«å……æ ¼æ•°
    }

    // è™šå‡½æ•°ï¼šæ˜¾ç¤ºæŠ€èƒ½ä¿¡æ¯ï¼ˆå­ç±»å¯ä»¥é‡å†™ï¼‰
    virtual void showSkillInfo() {
        cout << "[" << school << "] " << name << " çš„æŠ€èƒ½ä¿¡æ¯" << endl;
    }

    // è™šææ„å‡½æ•°ï¼ˆéå¸¸é‡è¦ï¼ï¼‰
    virtual ~Character() {}

    // è¾…åŠ©æ–¹æ³•
    string getName() const { return name; }
    string getSchool() const { return school; }
};

// ============================================
// Warrior æˆ˜å£«ç±» - è¯·å®Œæˆæ­¤ç±»
// ============================================
class Warrior : public Character {
private:
    int rage;  // æ€’æ°”å€¼ (0-100)

public:
    // TODO: å®ç°æ„é€ å‡½æ•°
    Warrior(string name, int hp, int attack)
        : Character(name, hp, attack, "æˆ˜å£«") {
        // åˆå§‹åŒ– rage
    }

    // TODO: é‡å†™ attack æ–¹æ³•
    void attack(Character* target) override {
        cout << "\n" << name << " å‘èµ·æ”»å‡»ï¼š" << endl;

        // TODO: åˆ¤æ–­æ€’æ°”æ˜¯å¦æ»¡100
        // å¦‚æœæ»¡100ï¼š
        //   - é€ æˆ attackPower * 3 ä¼¤å®³
        //   - è¾“å‡ºç‹‚æš´æ–‡æ¡ˆï¼š"ğŸ’¥ [ç‹‚æš´æ‰“å‡»] æ€’æ°”çˆ†å‘ï¼é€ æˆ X ç‚¹æ¯ç­æ€§ä¼¤å®³ï¼"
        //   - æ¸…ç©ºæ€’æ°”
        // å¦‚æœæœªæ»¡ï¼š
        //   - é€ æˆ attackPower ä¼¤å®³
        //   - è¾“å‡ºæ™®é€šæ–‡æ¡ˆï¼š"[æˆ˜å£«] æŒ¥èˆå·¨å‰‘ï¼Œé€ æˆ X ç‚¹ç‰©ç†ä¼¤å®³ï¼"
        //   - æ€’æ°” +20

        // æ˜¾ç¤ºæ€’æ°”å€¼
        cout << "æ€’æ°”å€¼: " << rage << "/100" << endl;
    }

    void showSkillInfo() override {
        cout << "ã€æˆ˜å£«æŠ€èƒ½ã€‘" << endl;
        cout << "- ç‹‚æš´æ‰“å‡»ï¼šæ€’æ°”æ»¡100æ—¶ï¼Œä¸‹æ¬¡æ”»å‡»é€ æˆ3å€ä¼¤å®³" << endl;
        cout << "- å½“å‰æ€’æ°”ï¼š" << rage << "/100" << endl;
    }
};

// ============================================
// Mage æ³•å¸ˆç±» - è¯·å®Œæˆæ­¤ç±»
// ============================================
class Mage : public Character {
private:
    int mp;     // å½“å‰é­”æ³•å€¼
    int maxMp;  // æœ€å¤§é­”æ³•å€¼

public:
    // TODO: å®ç°æ„é€ å‡½æ•°
    Mage(string name, int hp, int attack)
        : Character(name, hp, attack, "æ³•å¸ˆ") {
        // åˆå§‹åŒ– mp å’Œ maxMp
    }

    // TODO: é‡å†™ attack æ–¹æ³•
    void attack(Character* target) override {
        cout << "\n" << name << " å‘èµ·æ”»å‡»ï¼š" << endl;

        // TODO: åˆ¤æ–­é­”æ³•å€¼æ˜¯å¦è¶³å¤Ÿ
        // å¦‚æœ mp >= 20ï¼š
        //   - æ¶ˆè€— 20 MP
        //   - é€ æˆ attackPower * 1.5 ä¼¤å®³
        //   - è¾“å‡ºï¼š"âœ¨ [æ³•å¸ˆ] é‡Šæ”¾ç«çƒæœ¯ï¼Œé€ æˆ X ç‚¹é­”æ³•ä¼¤å®³ï¼"
        // å¦‚æœ mp < 20ï¼š
        //   - é€ æˆ attackPower * 0.5 ä¼¤å®³
        //   - è¾“å‡ºï¼š"[æ³•å¸ˆ] é­”åŠ›è€—å°½ï¼Œç”¨æ³•æ–æ•²å‡»ï¼Œé€ æˆ X ç‚¹ä¼¤å®³..."

        // æ˜¾ç¤ºé­”æ³•å€¼
        cout << "å‰©ä½™é­”åŠ›: " << mp << "/" << maxMp << " MP" << endl;
    }

    // TODO: å®ç°é­”åŠ›æ¢å¤æ–¹æ³•
    void restoreMana() {
        // æ¢å¤ 10 MPï¼Œä¸è¶…è¿‡ maxMp
    }

    void showSkillInfo() override {
        cout << "ã€æ³•å¸ˆæŠ€èƒ½ã€‘" << endl;
        cout << "- ç«çƒæœ¯ï¼šæ¶ˆè€—20MPï¼Œé€ æˆ1.5å€ä¼¤å®³" << endl;
        cout << "- å½“å‰é­”åŠ›ï¼š" << mp << "/" << maxMp << " MP" << endl;
    }
};

// ============================================
// Archer æ¸¸ä¾ ç±» - è¯·å®Œæˆæ­¤ç±»
// ============================================
class Archer : public Character {
private:
    int arrows;  // ç®­çŸ¢æ•°é‡

public:
    // TODO: å®ç°æ„é€ å‡½æ•°
    Archer(string name, int hp, int attack)
        : Character(name, hp, attack, "æ¸¸ä¾ ") {
        // åˆå§‹åŒ– arrowsï¼ˆåˆå§‹10æ”¯ï¼‰
    }

    // TODO: é‡å†™ attack æ–¹æ³•
    void attack(Character* target) override {
        cout << "\n" << name << " å‘èµ·æ”»å‡»ï¼š" << endl;

        // TODO: åˆ¤æ–­æ˜¯å¦æœ‰ç®­çŸ¢
        // å¦‚æœæœ‰ç®­çŸ¢ï¼š
        //   - æ¶ˆè€— 1 æ”¯ç®­çŸ¢
        //   - 30% å‡ ç‡è§¦å‘è¿å°„ï¼ˆä½¿ç”¨ rand() % 100 < 30 åˆ¤æ–­ï¼‰
        //   - è¿å°„ï¼šé€ æˆ attackPower * 2 ä¼¤å®³ï¼Œè¾“å‡ºï¼š"ğŸ¯ [è¿ç ç®­] å¿«é€Ÿè¿å°„ï¼é€ æˆ X ç‚¹ä¼¤å®³ï¼"
        //   - æ™®é€šï¼šé€ æˆ attackPower ä¼¤å®³ï¼Œè¾“å‡ºï¼š"ğŸ¹ [æ¸¸ä¾ ] ç²¾å‡†å°„å‡»ï¼Œé€ æˆ X ç‚¹ä¼¤å®³ï¼"
        //   - æ˜¾ç¤ºå‰©ä½™ç®­çŸ¢
        // å¦‚æœæ— ç®­çŸ¢ï¼š
        //   - é€ æˆ attackPower * 0.3 ä¼¤å®³
        //   - è¾“å‡ºï¼š"[æ¸¸ä¾ ] ç®­çŸ¢ç”¨å°½ï¼ŒåŒ•é¦–æ”»å‡»ï¼Œé€ æˆ X ç‚¹ä¼¤å®³..."
    }

    void showSkillInfo() override {
        cout << "ã€æ¸¸ä¾ æŠ€èƒ½ã€‘" << endl;
        cout << "- ç²¾å‡†å°„å‡»ï¼š30%å‡ ç‡è¿å°„é€ æˆåŒå€ä¼¤å®³" << endl;
        cout << "- å‰©ä½™ç®­çŸ¢ï¼š" << arrows << endl;
    }
};

// ============================================
// Assassin åˆºå®¢ç±» - æŒ‘æˆ˜ä»»åŠ¡ï¼ˆå¯é€‰ï¼‰
// ============================================
class Assassin : public Character {
private:
    int energy;        // èƒ½é‡å€¼
    bool stealthMode;  // éšèº«çŠ¶æ€

public:
    // TODO: å®ç°æ„é€ å‡½æ•°ï¼ˆæŒ‘æˆ˜ï¼‰
    Assassin(string name, int hp, int attack)
        : Character(name, hp, attack, "åˆºå®¢") {
        // åˆå§‹åŒ– energyï¼ˆåˆå§‹50ï¼‰ å’Œ stealthModeï¼ˆfalseï¼‰
    }

    // TODO: é‡å†™ attack æ–¹æ³•ï¼ˆæŒ‘æˆ˜ï¼‰
    void attack(Character* target) override {
        cout << "\n" << name << " å‘èµ·æ”»å‡»ï¼š" << endl;

        // TODO: å®ç°åˆºå®¢çš„æ”»å‡»é€»è¾‘
        // 1. å¦‚æœå¤„äºéšèº«çŠ¶æ€ï¼š
        //    - é€ æˆ attackPower * 5 ä¼¤å®³
        //    - è¾“å‡ºï¼š"ğŸ’€ [æš—å½±æš—æ€] ä»é˜´å½±ä¸­çªè¢­ï¼é€ æˆ X ç‚¹è‡´å‘½ä¼¤å®³ï¼ï¼ï¼"
        //    - è§£é™¤éšèº«çŠ¶æ€
        // 2. å¦‚æœæœ‰è¶³å¤Ÿèƒ½é‡ï¼ˆ>= 30ï¼‰ä¸”æœªéšèº«ï¼š
        //    - å¯ä»¥é€‰æ‹©è¿›å…¥éšèº«ï¼ˆè¿™é‡Œç®€åŒ–ä¸ºè‡ªåŠ¨è¿›å…¥ï¼‰
        //    - æ¶ˆè€— 30 èƒ½é‡
        //    - è¿›å…¥éšèº«çŠ¶æ€
        //    - è¾“å‡ºæç¤º
        // 3. æ™®é€šæ”»å‡»ï¼š
        //    - 50% å‡ ç‡æš´å‡»ï¼ˆ2å€ä¼¤å®³ï¼‰
        //    - æš´å‡»ï¼š"âš¡ [æš´å‡»] è‡´å‘½ä¸€å‡»ï¼é€ æˆ X ç‚¹ä¼¤å®³ï¼"
        //    - æ™®é€šï¼š"ğŸ—¡ï¸ [åˆºå®¢] åˆ©åˆƒæ”»å‡»ï¼Œé€ æˆ X ç‚¹ä¼¤å®³ï¼"
    }

    // TODO: å®ç°èƒ½é‡æ¢å¤æ–¹æ³•
    void restoreEnergy() {
        // æ¢å¤ 15 èƒ½é‡ï¼Œä¸è¶…è¿‡ 100
    }

    void showSkillInfo() override {
        cout << "ã€åˆºå®¢æŠ€èƒ½ã€‘" << endl;
        cout << "- æš—å½±æš—æ€ï¼šæ¶ˆè€—30èƒ½é‡ï¼Œä¸‹æ¬¡æ”»å‡»é€ æˆ5å€ä¼¤å®³" << endl;
        cout << "- æš´å‡»ï¼š50%å‡ ç‡é€ æˆ2å€ä¼¤å®³" << endl;
        cout << "- å½“å‰èƒ½é‡ï¼š" << energy << "/100" << endl;
    }
};

// ============================================
// Arena ç«æŠ€åœºç±» - è¯·å®Œæˆæ­¤ç±»
// ============================================
class Arena {
public:
    // TODO: å®ç° battle æ–¹æ³•
    void battle(Character* fighter1, Character* fighter2) {
        // æ˜¾ç¤ºæˆ˜æ–—å¼€å§‹ä¿¡æ¯
        cout << "\nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" << endl;
        cout << "â•‘        æˆ˜æ–—å¼€å§‹ï¼             â•‘" << endl;
        cout << "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£" << endl;
        cout << "â•‘  " << fighter1->getName() << " VS " << fighter2->getName() << endl;
        cout << "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" << endl;

        // TODO: æ˜¾ç¤ºåŒæ–¹åˆå§‹çŠ¶æ€
        cout << "\nåˆå§‹çŠ¶æ€ï¼š" << endl;
        // è°ƒç”¨ showStatus() æ–¹æ³•

        int round = 1;

        // TODO: å›åˆåˆ¶æˆ˜æ–—å¾ªç¯
        while (/* åŒæ–¹éƒ½è¿˜æ´»ç€ */) {
            cout << "\n======== ç¬¬ " << round << " å›åˆ ========" << endl;

            // TODO: fighter1 æ”»å‡» fighter2


            // TODO: æ˜¾ç¤ºæˆ˜å†µ
            cout << "\n--- æˆ˜å†µ ---" << endl;
            // æ˜¾ç¤ºåŒæ–¹çŠ¶æ€

            // TODO: åˆ¤æ–­ fighter2 æ˜¯å¦å­˜æ´»
            // å¦‚æœä¸å­˜æ´»ï¼Œè·³å‡ºå¾ªç¯

            // TODO: fighter2 åå‡»


            // TODO: æ˜¾ç¤ºæˆ˜å†µ


            // TODO: åˆ¤æ–­ fighter1 æ˜¯å¦å­˜æ´»
            // å¦‚æœä¸å­˜æ´»ï¼Œè·³å‡ºå¾ªç¯

            // TODO: å›åˆç»“æŸå¤„ç†
            // - æ³•å¸ˆæ¢å¤é­”åŠ›
            // - åˆºå®¢æ¢å¤èƒ½é‡

            round++;
        }

        // TODO: æ˜¾ç¤ºæˆ˜æ–—ç»“æœ
        cout << "\nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" << endl;
        cout << "â•‘        æˆ˜æ–—ç»“æŸï¼             â•‘" << endl;
        cout << "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£" << endl;
        // æ˜¾ç¤ºè·èƒœè€…
        cout << "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" << endl;
    }

private:
    // è¾…åŠ©æ–¹æ³•ï¼šæ˜¾ç¤ºåˆ†éš”çº¿
    void showSeparator() {
        cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" << endl;
    }
};

// ============================================
// ä¸»å‡½æ•° - è¯·å®Œæˆæµ‹è¯•ä»£ç 
// ============================================
int main() {
    // åˆå§‹åŒ–éšæœºæ•°ç§å­
    srand(time(0));

    cout << "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" << endl;
    cout << "â•‘                                               â•‘" << endl;
    cout << "â•‘      ğŸ® é­”æ³•å­¦é™¢æˆ˜æ–—ç«æŠ€åœº                    â•‘" << endl;
    cout << "â•‘      éœæ ¼æ²ƒå…¹å¹´åº¦å¤§èµ›                         â•‘" << endl;
    cout << "â•‘                                               â•‘" << endl;
    cout << "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" << endl;

    // TODO: åˆ›å»ºè§’è‰²ï¼ˆä½¿ç”¨åŸºç±»æŒ‡é’ˆï¼Œä½“ç°å¤šæ€ï¼‰
    // Character* warrior = new Warrior("å‹‡å£«é˜¿ç‘Ÿ", 120, 50);
    // Character* mage = ...
    // Character* archer = ...
    // Character* assassin = ...

    // TODO: åˆ›å»ºç«æŠ€åœº
    // Arena arena;

    // TODO: è¿›è¡Œæˆ˜æ–—æµ‹è¯•
    // æˆ˜æ–—1ï¼šæˆ˜å£« vs æ³•å¸ˆ
    // cout << "\nã€ç¬¬ä¸€åœºæˆ˜æ–—ã€‘" << endl;
    // arena.battle(warrior, mage);

    // æˆ˜æ–—2ï¼šæ¸¸ä¾  vs åˆºå®¢
    // ...

    // æˆ˜æ–—3ï¼šè·èƒœè€…å¯¹å†³
    // ...

    // TODO: é‡Šæ”¾å†…å­˜
    // delete warrior;
    // delete mage;
    // ...

    return 0;
}

/*
 * ============================================
 * å®ç°æç¤º
 * ============================================
 *
 * 1. ç”Ÿå‘½å€¼è¿›åº¦æ¡ç¤ºä¾‹ï¼š
 *    [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘] 80/100 HP
 *    è®¡ç®—æ–¹æ³•ï¼šfilled = (hp * 10) / maxHp
 *
 * 2. éšæœºæ•°åˆ¤æ–­ç¤ºä¾‹ï¼š
 *    if (rand() % 100 < 30) {
 *        // 30% å‡ ç‡è§¦å‘
 *    }
 *
 * 3. å¤šæ€ä½¿ç”¨ç¤ºä¾‹ï¼š
 *    Character* hero = new Warrior("é˜¿ç‘Ÿ", 100, 50);
 *    hero->attack(enemy);  // è‡ªåŠ¨è°ƒç”¨ Warrior çš„ attack
 *
 * 4. ç±»å‹è½¬æ¢ï¼ˆå¦‚æœéœ€è¦ï¼‰ï¼š
 *    Mage* mage = dynamic_cast<Mage*>(character);
 *    if (mage) {
 *        mage->restoreMana();
 *    }
 *
 * ============================================
 * ç¼–è¯‘å’Œè¿è¡Œ
 * ============================================
 *
 * g++ -std=c++11 05-ç»¼åˆå®è·µ-å­¦ç”Ÿç‰ˆ.cpp -o battle
 * ./battle
 *
 * ============================================
 * è¯„åˆ†è¦ç‚¹
 * ============================================
 *
 * 1. æ­£ç¡®ä½¿ç”¨ç»§æ‰¿å’Œå¤šæ€ (30åˆ†)
 * 2. æ‰€æœ‰è§’è‰²ç±»å®ç°æ­£ç¡® (40åˆ†)
 * 3. Arena æˆ˜æ–—é€»è¾‘å®Œæ•´ (20åˆ†)
 * 4. æµ‹è¯•å……åˆ†ï¼Œå†…å­˜ç®¡ç†æ­£ç¡® (10åˆ†)
 *
 * åŠ åˆ†é¡¹ï¼š
 * - è¾“å‡ºæ ¼å¼ç¾è§‚
 * - ä»£ç æ³¨é‡Šæ¸…æ™°
 * - å®ç°äº†åˆºå®¢ç±»ï¼ˆæŒ‘æˆ˜ï¼‰
 */